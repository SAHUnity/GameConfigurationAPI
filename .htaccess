    RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} (\.\.\/|\.\.\\|union|select|insert|drop|update|delete) [NC]
    RewriteRule .* - [F,L]
    
    # Block suspicious HTTP methods
    RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK|DEBUG|PUT|DELETE|CONNECT)$
    RewriteRule .* - [F,L]
    
    # Block direct IP access (optional - uncomment if you want to force domain access only)
    # RewriteCond %{HTTP_HOST} ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$
    # RewriteRule .* - [F,L]
</IfModule>

# PHP security settings
<IfModule mod_php.c>
    php_flag expose_php off
    php_flag display_errors off
    php_flag log_errors on
    # Set proper log path or remove this line to use php.ini default
    # php_value error_log logs/php_errors.log
</IfModule>

# Additional protection against common exploits
<IfModule mod_rewrite.c>
    # Block access attempts to common exploit paths
    RewriteCond %{REQUEST_URI} (\.php/|\.asp/|\.jsp/) [NC,OR]
    RewriteCond %{REQUEST_URI} (eval\(|base64_|gzinflate|str_rot13) [NC,OR]
    RewriteCond %{REQUEST_URI} (phpinfo|php_uname|chmod|chown|chgrp) [NC]
    RewriteRule .* - [F,L]
</IfModule>

# Prevent access to version control and config files
<FilesMatch "(\.(git|svn|htaccess|htpasswd)|composer\.(json|lock)|package(-lock)?\.json)$">
    Require all denied
</FilesMatch>